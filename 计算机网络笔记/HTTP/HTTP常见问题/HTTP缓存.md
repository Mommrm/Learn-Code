# HTTP缓存技术
简单来说多次请求同一个HTTP请求，就可以通过缓存来提升性能，HTTP缓存分为强制缓存和协商缓存

## 强制缓存
利用两个字段实现：
- Cache-Control: 相对时间(优先级较高)
- Expires: 绝对时间

一般使用Cache-Control，再次请求访问服务器资源时会对比请求资源的时间和设置的过期时间来计算资源是否已经过期
服务器收到请求后会更新Response头部种的Cache-Control

## 协商缓存

请求返回是304，这个是告知浏览器可以使用本地的缓存

第一种：请求头部中的 If-Modified-Since 字段与响应头部中的 Last-Modified 字段实现

第二种：请求头部中的 If-None-Match 字段与响应头部中的 ETag 字段

第一种实现方式是基于时间实现的，第二种实现方式是基于一个唯一标识实现的，相对来说后者可以更加准确地判断文件内容是否被修改，避免由于时间篡改导致的不可靠问题。

> 当使用 ETag 字段实现的协商缓存的过程：

>  - 当浏览器第一次请求访问服务器资源时，服务器会在返回这个资源的同时，在 Response 头部加上 ETag 唯一标识，这个唯一标识的值是根据当前请求的资源生成的；
  当浏览器再次请求访问服务器中的该资源时，首先会先检查强制缓存是否过期：
>  - 如果没有过期，则直接使用本地缓存；
>  - 如果缓存过期了，会在 Request 头部加上 If-None-Match 字段，该字段的值就是 ETag 唯一标识；
>  - 服务器再次收到请求后，会根据请求中的 If-None-Match 值与当前请求的资源生成的唯一标识进行比较：
>  - 如果值相等，则返回 304 Not Modified，不会返回资源；
>  - 如果不相等，则返回 200 状态码和返回资源，并在 Response 头部加上新的 ETag 唯一标识；
>  - 如果浏览器收到 304 的请求响应状态码，则会从本地缓存中加载资源，否则更新资源。